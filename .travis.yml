sudo: required
language: java
notifications:
  email: false
jdk:
- oraclejdk8
services:
- docker
before_script:
- curl -s ${SCRIPTS}/setup-tests.sh | bash /dev/stdin
script:
- gradle check -i
- curl -s ${SCRIPTS}/generate-bintray-descriptor.sh | bash /dev/stdin topic-forwarder build/distributions/topic-forwarder.tgz > .bintray.json
- curl -s ${SCRIPTS}/docker-build.sh | bash /dev/stdin enmasseproject/topic-forwarder . 
- curl -s ${SCRIPTS}/run-tests.sh | bash /dev/stdin enmasseproject/topic-forwarder ${COMMIT}
after_success:
- curl -s ${SCRIPTS}/docker-push.sh | bash /dev/stdin enmasseproject/topic-forwarder
after_failure:
- curl -s ${SCRIPTS}/teardown-tests.sh | bash /dev/stdin
env:
  global:
  - SCRIPTS=https://raw.githubusercontent.com/EnMasseProject/travis-scripts/master
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: xgpSWu72da+5s7SbmzpNRl3rLfFAjAoFa3uUjqXrbH2EIz315lVqfwDDAblGHJtmMDCE7aem5t2SXmgL8MkyvT0r1mEoEcKZL67TiLjyFUlPlfEMo/YSmTOxfKDmbLIuomQV85P2CuRaZzz+j+GjBC1DfVpIWrsq4Rg40kQmFvSko43YlVyViML4NLBrxN2pebvXAIfNj3ulCkxRysNPSkbmVaFC+u62EfhJ/pA0DoR59Mk4O/Hb3zFL9fWqCcZNB0PrSCE/boqHXzJIMa5mVZNRDF+ga1LEeiZ0wY502d583WgpA3KT1UBMzgeIOSJR3m4y1//1QiGcpByW2Nn8Wqo7iISKem3Odsz6qM5/WfxFuGmnMEigN2fcZAiPo2GTxHKRllBT9SlnUiW1QX2CphxQ2Rgi9qhSHnGVVdMrN2sg6zQ51qqEI7nNQhp1CFXn5Yc8mPG4KbDOMlad8lQzNTiCCfhqi+Gy9O0lxHs/yIEIJbPBMw6kwqFwWwqXf2/61EkmOGtqhj/lpW45DLYhtZonMQbk/cZX07uMMND8ZY8rJygTeCFTuFJmArqzDEstYJYz7L7/2xc8jmLKtF6qaQTitYP+eckEA+hfGuZXJquQB1DffcWm93royvPtuaiEu7WdQ3KJrAhldj81JI95nNka+MkRxMU9VKKy7zrQxM4=
  - secure: pE1oUMQfmLVcDkrKMHmCgizfeHYoD2npP/nt33uG3V25p454+tealQIIaQxXuAUob3IeUqNJnBH50bFgaQjcQJa4q3vgzorpVr7PCQnct7c/rbs0Ky4J9yVA45dnxs0UE92z9u2vGp/lf5yhyj0c+ZThukXIQV8OyoX0SIppDFSKUraMojND993HYPcIjkITHsPJkWaN4ngzRRdVjcZYtxAlqOIttpMJZuBeyBu8M3AVdbSL04Uo9kAX4f9vmeqygT4uxl9IWDSc22QH1/uqOA0Q2qzEYDIOpXAebUGFePWmp0iaHJYbDmJSuDyYm3nMdYh2GfFTwKxBS8txu1402OxWBMDreoJewW+92v7Ui3D6SPdERZXn6Qa/JQKQmftk9FiNkB5DJTlbDkAMFh7O/E9+jDxbwgxfVVCqPqNtcs0AnRLz0eNrKFWKz5pd/KPEJMgOifYhpmy5VAfKDIvlKO9rf3MOs21olkX1Tqj+DWmm8cg4nwyXMnyHeDItMNv5BC7E+w8HPFnzH6RaH/ASK+JjYjo9CdbW/GmZ7lXlpg/F9VLQNyQhAdsIIuoSSDIQZoGvqwD0vHI7NLDtz9VxnkpSy2V/4BsivRIIzVvfE0cXeyzScJvg2OAgUi+3z8fIFoD8d1tjIZ7URfC36/ThAztCryxqzKmf0n2NQ9L5i6A=
  - secure: tTWypmF82Ld5y6MUOV/zsUtSiGzh3uVb8P42s+jGBOafCdtoXEkew75uxPrkDLwbbqoqg/zVNHO6zTVns/5LLZGigXYJtkyzF3zm9tcUKt4e3dBd422Mz5XBmsfO10x/qsL2YbduafJd8fhMqHc5jY1BQPIdLU0hLcHST4eXsRw08UGG3BjAQCuJHuw4jX/DhxyFseY4fileKKGXwtYG6QjGxuwGg/KjJWBSlJNlaq+Xmjj4dLQne3PkX0GVCl0ad/NGfvlvvxKYaVIu+9ALlVB4cd8udZ25VumnROjNBqGFArla2qd0BN3Bto02lOmQmLKrSfb0+ILYg9k7wL1HpDykWmXciCMCyTTpmZLOr81ms8xptjiWAZlxLiTuUqexkZMXKp4VeQYvzWi6xuwpamTGifUz5Ds8Gal31sxkn+HT5ekEYu45KuBv+gfgdJXqnJQP2ME98A55kCA/ql90t8HACRNbKYC1511A/IndZ4iDfh+l79RcK1UbwuDK61Rcxr6//TCIbT9AuVlSHRDGxdO6B2ytNW7UdgnR8X27WP6XN37N92NZ2aVarpIBG6iWLVFdCm6g57dD+7+umXbIqJPAXSYdc7RhN2QPnDFCY6gM54uf5C8ZUPwQVCFPel47eNA+C4vsr1JtbctakQh7oeTJwt6pHCco6dPw9SiUtEs=
  - secure: d2djluXOIwMAhrJZt9HuuWzQFMytUh/oNBSWPx7LUxSjlMN5XlvXqVYLUNn7mYyt3ttqhJfK+kiuDMxCC1TUdbi8ulH4pm3wePQoZ+9ik5quau1RDBb+Q3qgI2NegKJ3rkxdo3luQV3SJuF1S0PSGk8BmNxXGdT1PLgcCyGBVvR0oSXxkC0xGADd1Oi+VOD92TXBEgoTE8jHm4EQFwQxCTj5QWHfR4Mxh4BisXkeY53t1153jaGWNgw11yqmC1g+FCTqG9peU7UccLBieyKtVvNx1Jzp/5tju/38QnYGkBN/HWO00ciS/mq4Tv6VxftWKjW64jCAzC/O6gAS1sW6x5MeQHQZlIWBU77KisvUDB1jEdoxMcPcuMbHIynk45W9sTeRNwcepMGexl19wUytSjg4VhPDvEPlEWA46C4I+gMyM8PlUlc71zZhgqYzARi4L6SmOvYNkhuJIbq/UV4URLhfflUi5R1y5vSNcDVEVtn8pKA9QlP1SEmahbQZ8e4yalQSOaeraX+NMD/lYBnO5tdwmGOUWfnq/hBkz9oaUixplzNb81w85OGPiJXZGFoMx1WWQw2QSbGbigK2QJtX59O0mtt4d0/wEiyIBssNT7jRYMFw3hDt3UPIu6oAUYLmwznHES9RzLNl/ocEd9ogMz4DQ0Pl7sTMs22n4N6P/b8=
  - secure: qsL4EzI07jW8x31sAcjWbm+x76QiMtYnUOi75JMdDU+mDt8Z9dNWFvXs6nA/rfN9B6BrjDHLCN8ZaFkG5gep96SouJm96mPksQMlrP27E+vd2pn9xgPbkDhX6KH30tmeEQB52kYABg6LKivwb8+4gdpZ+repUDpevwCcKSVgpHnpDThdezln5WCvqZQoFvgaTh4Ig+GTodml0m46vMQoxb/tlD3sauF335BeVBEEPYlxtY2IUvtALt9i1nlKuIFXu+jt++nVGafYjMZRiWlQCJcOwJOOH/dpcF21m1Kf6/9/lrDkJ6fGgUNWlJ7FsZ/CnbzNIKO+k/jhqJrJvRmRlK+BhO485aUZQ6nNbpThpWfWSN2aygd1BaOJn5g4My3/+AqAQDWbO33bKMgO8+8niBmlKCuhPETrlC6aYSLWbb8r6Ob+SKMVhMpgRp+fs9PzLYUIrsBw+0YUgJdPjHy0MpODCrVv7TfUbIzTskwFSmUmRE68HMOLI97YoqPb4RyKGODEG5T4QR5lSOKvw6ec/DrFAcCAl5tD4eM5EbZfZPRAU6L0F/3VEibqEJFYL7Nz5UBzWwdX2ooB/uEUiMKX9nb0l72npxQIwLDbXO0xnL8NPih/AgHARq6Kfa6+U0BxEccl/vwt4/KncCIl6zu2PL/eRTSGhlLwNBa8yAfWG4E=
deploy:
  - provider: bintray
    file: ".bintray.json"
    user: "${BINTRAY_API_USER}"
    on:
      tags: true
    key:
      secure: hxkUkR88Yz5Ol1sU/EvEE2/FujpVfUGTKZmepTr5M3/9AlGLzAL0xJpnX+6m9njrJ3jFNAWeIvxveYGTEMQu8XlVVNYoTQQnFkHQqPBUZ9/qLtfAQEb8IAIDEMaIFI9JMXTZmMA09bE4o5uANOLxHEeBFsLz0Wb6k+PP+ja9oKEj8umfEe1Ppja+kXtYxc+9lUE0aKtgx9El0AXGQn1QFYbN8DOE7UiE66HYeJwW0cWimBZdaPJmP02FjZZnsxXUTrryug1K6f6HB6erzKoTcVPkR6l2QzZEAtlU1/dTqyGO70qTLHby86NTBxqlvLvjIHyH9EcSu9mgI5EIsp1Ae35tlDvceXnZPnSWSG+hOCaGEGzzrn64ijlybp+pdAISd1SzIxNqLr96KlgZ+NkQxr2LB7n1dOOA9Av7jAu6XkoxkxTdPu7ZeRj7Hxd5DYSOpV9qrbanVTEkIBaJOlL32oNJSX+vmll5zZ+CjZrtDdlcgTJ/BheLdnT5ShUoJ/Uj370BEjp4wQvXfVyt29eDIOWKH219gifrEJhnSLO7W6uZ9k1e/F+mcKlHZq6G9bLONS+TKkJNnaKjjq/hZ003nOZs5GGzZ8aCinmnuXkuNTVpUh9SZEZ/xc6EPzI0DUVS46OjFDBOjcDQFkma9H4Uaw36GRBxJgYJsAZw3p9s5KM=
  - provider: bintray
    file: ".bintray.json"
    user: "${BINTRAY_API_USER}"
    key:
      secure: hxkUkR88Yz5Ol1sU/EvEE2/FujpVfUGTKZmepTr5M3/9AlGLzAL0xJpnX+6m9njrJ3jFNAWeIvxveYGTEMQu8XlVVNYoTQQnFkHQqPBUZ9/qLtfAQEb8IAIDEMaIFI9JMXTZmMA09bE4o5uANOLxHEeBFsLz0Wb6k+PP+ja9oKEj8umfEe1Ppja+kXtYxc+9lUE0aKtgx9El0AXGQn1QFYbN8DOE7UiE66HYeJwW0cWimBZdaPJmP02FjZZnsxXUTrryug1K6f6HB6erzKoTcVPkR6l2QzZEAtlU1/dTqyGO70qTLHby86NTBxqlvLvjIHyH9EcSu9mgI5EIsp1Ae35tlDvceXnZPnSWSG+hOCaGEGzzrn64ijlybp+pdAISd1SzIxNqLr96KlgZ+NkQxr2LB7n1dOOA9Av7jAu6XkoxkxTdPu7ZeRj7Hxd5DYSOpV9qrbanVTEkIBaJOlL32oNJSX+vmll5zZ+CjZrtDdlcgTJ/BheLdnT5ShUoJ/Uj370BEjp4wQvXfVyt29eDIOWKH219gifrEJhnSLO7W6uZ9k1e/F+mcKlHZq6G9bLONS+TKkJNnaKjjq/hZ003nOZs5GGzZ8aCinmnuXkuNTVpUh9SZEZ/xc6EPzI0DUVS46OjFDBOjcDQFkma9H4Uaw36GRBxJgYJsAZw3p9s5KM=
